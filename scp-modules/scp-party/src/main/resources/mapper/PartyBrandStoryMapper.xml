<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bjzhianjia.scp.party.mapper.PartyBrandStoryMapper">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.bjzhianjia.scp.party.entity.PartyBrandStory" id="partyBrandStoryMap">
        <result property="id" column="id"/>
        <result property="brandId" column="brand_id"/>
        <result property="storyTitle" column="story_title"/>
        <result property="storyContent" column="story_content"/>
        <result property="storyDate" column="story_date"/>
        <result property="storyUpdDate" column="story_upd_date"/>
        <result property="storyStateCode" column="story_state_code"/>
        <result property="crtUserId" column="crt_user_id"/>
        <result property="crtUserName" column="crt_user_name"/>
        <result property="crtTime" column="crt_time"/>
        <result property="updUserId" column="upd_user_id"/>
        <result property="updUserName" column="upd_user_name"/>
        <result property="updTime" column="upd_time"/>
        <result property="deptId" column="dept_id"/>
        <result property="tenantId" column="tenant_id"/>
    </resultMap>

    <!-- 获取指定数量，根据状态最新的品牌列表 -->
    <select id="getBrandByTimeAndState" resultType="com.alibaba.fastjson.JSONObject">
        SELECT
        pbs.story_title storyTitle, bsf.file_url fileUrl
        FROM
        party_brand_story pbs
        LEFT JOIN
        brand_story_file bsf on pbs.id = bsf.story_id
        WHERE
        pbs.story_state_code = #{state}
        AND bsf.file_url != '[]'
        AND pbs.is_deleted = #{isdel}
        ORDER BY
        story_date  DESC
    </select>

    <!--获取指定党组织下活动列表-->
    <select id="getBrandByBrandId" resultType="com.alibaba.fastjson.JSONObject">
        SELECT
        pbs.story_title storyTitle, bsf.file_url fileUrl,pbs.story_state_code storyStateCode,bsf.file_name fileName,pbs.story_content storyContent,pbs.story_date storyDate
        FROM
        party_brand_story pbs
        LEFT JOIN
        brand_story_file bsf on pbs.id = bsf.story_id
        WHERE
        pbs.brand_id = #{id}
        AND bsf.file_url != '[]'
        AND pbs.is_deleted = #{isdel}
        ORDER BY
        story_date  DESC
    </select>
</mapper>